kind: BuildConfig
apiVersion: v1
metadata:
  name: sample-node-pipeline
spec:
  runPolicy: Serial
  strategy:
    type: JenkinsPipeline
    jenkinsPipelineStrategy:
      jenkinsfile: |-
        node('') {
          stage 'build'
            openshiftBuild(namespace: 'dev', buildConfig: 'sample-node', showBuildLogs: 'true')
          stage 'deploy DEV'
            openshiftDeploy(namespace: 'dev', deploymentConfig: 'sample-node')
            openshiftScale(namespace: 'dev', deploymentConfig: 'sample-node', replicaCount: '2')
          stage 'deploy QA'
            input 'Proceeed ?'
            openshiftTag(namespace: 'dev', sourceStream: 'sample-node', sourceTag: 'latest', destinationNamespace: 'qa', destinationStream: 'sample-node', destinationTag: 'latest')
            openshiftDeploy(namespace: 'qa', deploymentConfig: 'sample-node')
            openshiftScale(namespace: 'qa', deploymentConfig: 'sample-node', replicaCount: '2')
        }
